"use strict";angular.module("odoo",[]);
"use strict";angular.module("odoo").provider("jsonRpc",function(){this.odooRpc={uniq_id_counter:0,callBackDeadSession:function(){},callBackError:function(){}},this.$get=["$http","$rootScope",function(e,o){var s=this.odooRpc;return console.log(o),s.sendRequest=function(n,i){var r=$.Deferred();i.session_id=o.session_id,s.uniq_id_counter+=1;var t={jsonrpc:"2.0",method:"call",params:i},c={method:"POST",url:n,data:JSON.stringify(t),headers:{"Content-Type":"application/json"},id:"r"+s.uniq_id_counter};return e(c).success(function(e){if(console.log("SUCCESS"),console.log(e),"undefined"!=typeof e.error){var o=e.error;300===o.code&&(console.log("ERRROOOOOR"),console.log(e.error),o.data&&("client_exception"==o.data.type&&o.data.debug.match("SessionExpiredException")?(console.log("session dead"),s.clearCookieSession()):callBackError(o)),r.reject(e.result))}else r.resolve(e.result)}),r.promise()},s.login=function(e,n,i){var r={db:e,login:n,password:i};return s.sendRequest("/web/session/authenticate",r).then(function(e){return o.session_id=e.session_id,!0})},s.searchRead=function(e,o,n){var i={model:e,domain:o,fields:n};return s.sendRequest("/web/dataset/search_read",i)},s.call=function(e,o,n,i){var r={model:e,method:o,args:n,kwargs:i};return s.sendRequest("/web/dataset/call_kw",r)},s.getSessionFromCookie=function(){for(var e="sid=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i];" "==r.charAt(0);)r=r.substring(1);0==r.indexOf(e)&&(o.session_id=r.substring(e.length,r.length),console.log("CHECKK SSESSSION"),console.log(o.session_id),o.session_id&&s.searchRead("res.user",[],["login"]))}},s.clearCookieSession=function(){function e(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}console.log("CALL CLEAR COOKIES"),e("sid"),o.session_id=""},s}]});
angular.module("odoo").run(["$templateCache",function(t){t.put("app/main/main.html",'<div class="container"><input type="text" ng-model="login"> <input type="text" ng-model="password"> <button ng-click="loginFn()">Login</button> <input type="text" ng-model="db"></div>')}]);